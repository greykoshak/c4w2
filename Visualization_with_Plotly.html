<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Visualization_with_Plotly</title>
    <style type="text/css">
        body {
            font-family: verdana, arial, sans-serif;
        }
        b {
            font-size: 125%;
            color: blue;
        }
        i {
            font-size: 110%;
            color: green;
        }
    </style>
</head>
<body>

<div><p>
    В предыдущих видео мы научились делать визуализации, которые были статичными. Мы брали данные, рисовали график,
    получали картинку. И либо оставляли ее в ноутбуке, либо сохраняли как изображение или PDF и встраивали в свою
    статью. В этом видео мы познакомимся с библиотекой визуализации данных <b>Plotly</b>, которая позволяет делать
    интерактивные визуализации. Для этого она использует браузер и использует JS-библиотеку тоже Plotly, которая
    позволяет делать визуализацию, с которой вы можете взаимодействовать. Со стороны Python вам понадобится тоже
    библиотека Plotly, которую нужно установить и ее можно использовать в двух режимах. Один режим — это онлайн-режим,
    когда у вас используется сервер Plotly, вам нужно получить логин, пароль и это позволяет вам сохранять ваше
    изображение в облаке и иметь к нему доступ в любой момент с любого устройства. Второй способ — это оффлайн-режим,
    когда вы используете визуализацию и библиотеку визуализации, которая у вас есть локально на вашей машине и вы можете
    все визуализировать у себя в браузере и возможно потом сохранять в облако дополнительной кнопкой. Здесь показаны два
    способа импортирования plotly: первый — онлайн, второй — оффлайн. Мы импортируем plotly оффлайн и для создания
    визуализации импортируем все графы объекта, которые есть в библиотеке from <b>plotly.graph_objs import*</b> Графы
    объекта — это те объекты, которые вы используете, чтобы создавать визуализации. Также для того чтобы визуализировать
    данные через plotly или IPython Notebook, нам нужно вызвать метод init_notebook_mode. Что он делает? Он берет весь
    js и все css стили, которые нужны библиотеке для визуализации, и встраивает их в ваш IPython Notebook. У него еще
    есть параметр — connected, который может быть True или False. Но default — он False и означает, что используется
    JS-библиотека из plotly package Python, и поэтому вам не нужен вообще Интернет, чтобы работать. Во втором случае,
    если connected будет True, то ваш JPython Notebook будет меньше весить, и будет использоваться в real-time и
    скачиваться с сайта plotly вся JS-обвязка. Хорошо, мы инициализировали наш plotly. Что нам делать дальше? Нам нужно
    скачать какой-то dataset. Мы будем использовать pandas для манипуляции с dataset-ом. И возьмем dataset, который
    предоставляет plotly. Это dataset, который рассказывает нам о данных GDP, то есть о валовом продукте, и
    продолжительности жизни в разных странах, на разных континентах: в Америке и в Европе. Таким образом он выглядит.
    И мы его подготовим для дальнейшей визуализации, отсортировав dataset по GDP, по валовому продукту. Для создания в
    изуализации в plotly используется такое понятие, как trace. Trace — это визуализация какого-то одного распределения
    данных. В нашем случае мы будем делать trace в виде scatter plot, то есть точек или линий. И для этого мы используем
    объект scatter. Мы говорим, что trace = Scatter, и передаем ему туда два параметра. Один — это x, то есть что у нас
    будет по x-оси. По x-оси у нас будет GDP. Plotly здесь может работать со списком, может работать с Series из
    датафрейма. Очень удобно. И нам нужен y. y у нас будет df.life_exp. Итак, мы передали два параметра. Что нам нужно
    сделать дальше? Дальше нам нужно создать объект data, который инкапсулирует в себе все те графики, которые мы хотим
    нарисовать. В данном случае у нас всего один график, один trace. Поэтому мы делаем массив из одного trace. И с этим
    объектом мы можем идти к plotly, в данном случае к оффлайн его версии, и сказать iplot что-то, а именно data.
    Отлично, мы получили такой график, где мы видим line chart, где по x у нас — GDP в количестве десятков тысяч
    долларов, а по y — средняя продолжительность жизни. Как мы видим, продолжительность в среднем растет с ростом GDP.
    И что классного, про plotly, как мы видим, — это интерактивный график. Мы наводим на конкретное значение, и даже
    если у нас всего пять засечек на полосе x, мы видим конкретные значения x и y, которые принимают наши данные. Мы
    также можем выделить часть графика таким образом, зазумиться, и увидеть более детальное распределение в каком-то
    диапазоне. Можно zoom out, zoom in, autoscale, чтобы показал нам весь наш график, и можем нажать на кнопку
    «Сохранить» наше изображение или сохранить его в облаке, где вам будет предложено создать аккаунт, чтобы вы могли
    делиться вашим изображением. Сейчас мы изобразили один график. Давайте сделаем несколько графиков или несколько
    trace-ов. Для этого чуть обработаем наш датасет. Сделаем следующие вещи: сделаем новую колонку population, куда мы
    извлечем из строки country ее население. И сделаем колонку name, где мы запишем название страны. И также разобьем
    наш data frame на два. Один, который на континенте — Америка, второй, который на континенте — Европа. Отлично, у нас
    есть два data frame. Мы создаем два trace. Trace один и trace два. Trace один — это тот же scatter, но не на всем
    data frame, а на americas. Trace два — это то же самое, но на europe data frame. Получившиеся два trace мы передаем
    в массив и передаем в объект data, чтобы показать две визуализации. Запустим и видим два line chart разного цвета и
    с легендой. Но легенды ничего не говорят нам о том, какой из них чем является. Давайте исправим это, модифицировав
    наш trace scatter. Объект scatter и сам trace отвечают за то, как выглядит конкретная одна визуализация.
    Соответственно, нам можно как передать данные, так и можно настроить какие-то параметры, например, можно написать
    параметр name и указать, что это Americas. У trace два укажем параметр name и скажем, что это Europe. Наша легенда
    видоизменилась, у нас теперь написаны нормальные названия двух наших графиков. Кажется, что line chart не идеально
    подходит для данной визуализации. Куда проще было бы сделать просто точки, как в scatter plot. Для этого мы можем
    настроить наш scatter trace, указав ему режим, в котором он рисуется. В данном случае нас интересует режим markers и
    мы сделаем это у обоих графиков, у обоих trace-ов. Всего мы видим два набора точек. Но когда мы наводимся на одну из
    точек, мы не знаем, что это за страна, что не очень удобно, но мы можем это исправить, передав в параметр
    <b>text</b> список из названий, где названия будут названия наших стран, которые также хранятся в нашем data frame.
    В одном случае это americas_name. Во втором случае — это europe_name. Теперь мы знаем очень много. Мы наводим на
    конкретную точку, видим, сколько там GDP, какая там продолжительность ожидаемая жизни. И видим конкретное название
    страны. Для того чтобы предоставить еще больше контекста нашей визуализации, мы можем изменять размер точки в
    зависимости от какого-то параметра. Скажем, будем изменять его в зависимости от размера населения. Это поле хранится
    у нас в data frame, в ключе population. И для изменения этого размера нам нужно указать параметр marker. Мы делаем
    marker следующим образом. Мы говорим: marker — это словарь, у которого есть ключ size, и этот size будет такой же,
    как в population. Но если мы скажем просто population, то размеры будут миллионы, что заполонит нам весь график,
    поэтому мы нормализуем это на максимальное значение — население и умножаем, скажем, на 20, чтобы получить размер
    наших точек от нуля до 20. Посмотрим, что из этого получится. Теперь у нас разного размера наши точки. Мы сразу
    видим, что какая-то страна большая, у нее большой GDP и достаточно высокая продолжительность жизни ожидаемая. А есть
    какие-то маленькие страны, а какие-то страны совсем маленькие, мы их даже не видим. Если мы зазумимся, мы сможем
    увидеть эти страны. И это особенность plotly, что мы можем таким образом все-таки увидеть больший диапазон значений,
    чем мы могли бы, если бы у нас была статическая визуализация. Но в то же время кажется, что указание размера страны
    как размер нашей точки, не очень хорошее решение, потому что многие точки пропали после этого. Поэтому давайте
    уберем этот параметр. Таким образом, мы познакомились с библиотекой визуализации данных, которая позволяет нам
    делать интерактивные графики, с которыми мы можем взаимодействовать в IPython Notebook, сохранить его все так же в
    виде изображения или встроить в веб-сайт, зарегистрировавшись на сайте plotly.
</p></div>

</body>
</html>